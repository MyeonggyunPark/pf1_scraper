{% extends "base.html" %}

{% block content %}

<!-- Displaying search results Section -->
<section class="text-cstivory hidden md:block">

  <!-- keyword + site info -->
  <div class="mb-7 flex justify-between">
    <div class="flex">
      <h3 class="text-2xl flex items-center">
        Search results for "{{ keyword }}" on 
      </h3>

      <!-- Site toggle button  -->
      <button id="siteToggleBtn"
        class="text-2xl px-3 py-1 ml-4 text-cstivory border-b-2 border-cstivory hover:text-cstYellow cursor-pointer">
      <!-- Text will be inserted dynamically by JS -->
      </button>
    </div>

    <div>
      <!-- Back to Home Button -->
      <a 
        href="{{ url_for('home') }}" 
        class="inline-block text-lg mr-4 px-3 py-2 bg-cstBlue text-cstivory rounded-md hover:text-cstYellow font-semibold"
      >
        New Search
      </a>
        
      <!-- CSV export button -->
      <a 
        href="{{ url_for('export') }}?keyword={{ keyword }}&site={{ site }}"
        class="inline-block text-lg px-4 py-2 bg-cstBlue text-cstivory rounded-md hover:text-cstYellow font-semibold"
      >
        <i class="fas fa-file-csv"></i> 
        <span>CSV</span>
      </a>    
    </div>
  </div>

  <!-- Job results table -->
  <div class="overflow-x-auto">
    <table class="min-w-full table-auto border-collapse border border-gray-600">

      <!-- Table header -->
      <thead class="bg-cstdarkGray text-lg">
        <tr>
          <th class="border border-gray-600 px-4 py-2 text-left">Position</th>
          <th class="border border-gray-600 px-4 py-2 text-left">Company</th>
          <th class="border border-gray-600 px-4 py-2 text-left">Location</th>
          <th class="border border-gray-600 px-4 py-2 text-left">Link</th>
        </tr>
      </thead>

      <!-- Table body -->
      <tbody class="text-md divide-y divide-gray-700">
        {% for job in jobs %}
        <tr class="hover:bg-gray-800 transition-colors">
          <td class="px-3 py-2">{{ job.job_title }}</td>
          <td class="px-3 py-2">{{ job.company_name }}</td>
          <td class="px-3 py-2">{{ job.company_location }}</td>
          <td class="px-3 py-2 text-center text-cstBlue hover:text-cstYellow">
            <a href="{{ job.job_link }}" target="_blank" class="font-semibold">
              View
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</section>


<!-- Mobile Displaying search results Section -->
<section class="md:hidden">
  
  <div class="flex flex-col items-center gap-3">

    <!-- Mobile keyword -->
    <div class="text-cstivory text-2xl flex justify-center">
      <h3 class="border-2 border-gray-500 rounded-md px-25 py-2 flex items-center">{{ keyword }}</h3>
    </div>
    
    <div class="flex justify-between gap-10">
      <a href="{{ url_for('home') }}" 
        class="inline-block text-base px-3 py-2 bg-cstdarkGray border-2 border-gray-500 text-cstivory rounded-md font-semibold">
        New Search
      </a>
      <!-- Mobile Back to Home Button + CSV export button -->
      <a 
        href="{{ url_for('export') }}?keyword={{ keyword }}&site={{ site }}"
        class="inline-block text-base px-3 py-2 bg-cstBlue border-2 border-gray-500 text-cstivory rounded-md font-semibold"
      >
        <i class="fas fa-file-csv"></i> 
        <span>CSV</span>
      </a> 

    </div>
  </div>
  
  <!-- Mobile Site toggle button  -->
  <div class="text-cstivory flex justify-center mt-8">
    <ul class="text-xl font-semibold flex gap-6 uppercase">
      <li class="w-25 text-center py-2 border-2 border-gray-500 rounded-md {% if site == 'bsj' %} bg-cstBlue {% else %} text-gray-500 {% endif %}">
        <a href="{{ url_for('result') }}?keyword={{ keyword }}&site=bsj">bsj</a>
      </li>
      <li class="w-25 text-center py-2 border-2 border-gray-500 rounded-md {% if site == 'wwr' %} bg-cstBlue font-semibold {% else %} text-gray-500 {% endif %}">
        <a href="{{ url_for('result') }}?keyword={{ keyword }}&site=wwr">wwr</a>
      </li>
      <li class="w-25 text-center py-2 border-2 border-gray-500 rounded-md {% if site == 'ssd' %} bg-cstBlue font-semibold {% else %} text-gray-500 {% endif %}">
        <a href="{{ url_for('result') }}?keyword={{ keyword }}&site=ssd">ssd</a>
      </li>
    </ul>
  </div>
  
  <!-- Mobile Job results Card -->
  <div class="mt-10">
    {% for job in jobs %}
      <a 
        href="{{ job.job_link }}" 
        target="_blank"
        class="block m-4 p-4 rounded-md border-2 border-gray-500 bg-cstdarkGray"
      >
        <h4 class="text-lg font-semibold text-cstivory mb-2">
          {{ job.job_title }}
        </h4>
        <p class="text-cstBlue font-semibold">
          {{ job.company_name }}
        </p>
        <p class="text-sm text-gray-400">
          {{ job.company_location }}
        </p>
      </a>
    {% endfor %}
  </div>


</section>

{% endblock %}